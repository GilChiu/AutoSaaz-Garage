<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUSICA - Music Jukebox</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Top right composite circle -->
    <img src="assets/top-right.png" alt="" class="top-right-corner" aria-hidden="true">
    <!-- Bottom left composite circle -->
    <img src="assets/bottom-left.png" alt="" class="bottom-left-corner" aria-hidden="true">
    <!-- Header -->
    <header class="header">
        <div class="container header-abs-center">
            <div class="hamburger-menu" id="hamburgerMenu" aria-label="Open menu" tabindex="0">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="10" y="32.4004" width="28" height="3.2" rx="1.6" fill="#7C7256"/>
                  <rect x="10" y="22.4004" width="28" height="3.2" rx="1.6" fill="#7C7256"/>
                  <rect x="10" y="12.4004" width="28" height="3.2" rx="1.6" fill="#7C7256"/>
                </svg>
            </div>
            <img src="assets/musica-logo.png" alt="MUSICA logo" class="logo" draggable="false">
            <div class="header-spacer"></div>
        </div>
    </header>

    <!-- Search Section -->
    <section class="search-section">
        <div class="container">
            <div class="search-wrapper">
                <input type="text" id="searchInput" class="search-input" placeholder="Search for songs / artists">
                <button class="search-btn" id="searchBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </button>
            </div>
        </div>
    </section>

    <!-- Navigation Tabs -->
    <nav class="tab-navigation">
        <div class="container">
            <div class="tab-list">
                <button class="tab-btn songs-title" data-tab="songs-title">Songs by Title</button>
                <button class="tab-btn songs-tags" data-tab="songs-tags">Songs by Tags</button>
                <span class="credits">Credits: <span id="creditsCount">3</span> ðŸ•’ <span id="timeRemaining">4:39</span></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
                <div class="song-list" id="songList">
                    <div class="white-outline-box" id="upNextFirstSong">
                        <div class="song-row">
                            <img src="assets/default-artwork.svg" alt="Artwork" class="song-artwork" />
                            <div class="song-info">
                                <span class="song-title"></span><br>
                                <span class="song-artist"></span>
                            </div>
                            <button class="vote-box">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="11" y="4" width="2" height="16" rx="1" fill="#AC9D78"/>
                                    <rect x="4" y="11" width="16" height="2" rx="1" fill="#AC9D78"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="white-outline-stack" id="upNextOtherSongs">
                        <div class="song-row">
                            <img src="assets/default-artwork.svg" alt="Artwork" class="song-artwork" />
                            <div class="song-info">
                                <span class="song-title"></span><br>
                                <span class="song-artist"></span>
                            </div>
                            <button class="vote-box">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="11" y="4" width="2" height="16" rx="1" fill="#AC9D78"/>
                                    <rect x="4" y="11" width="16" height="2" rx="1" fill="#AC9D78"/>
                                </svg>
                            </button>
                        </div>
                        <div class="song-row">
                            <img src="assets/default-artwork.svg" alt="Artwork" class="song-artwork" />
                            <div class="song-info">
                                <span class="song-title"></span><br>
                                <span class="song-artist"></span>
                            </div>
                            <button class="vote-box">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="11" y="4" width="2" height="16" rx="1" fill="#AC9D78"/>
                                    <rect x="4" y="11" width="16" height="2" rx="1" fill="#AC9D78"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

            <!-- Browse Section -->
            <section class="browse-section" id="browseSection">
                <!-- A-Z Navigation for Songs by Title -->
                <div class="tab-content" id="songs-title-content">
                    <div class="alphabet-nav" id="alphabetNav">
                        <!-- Alphabet navigation will be generated here -->
                    </div>
                    <div class="song-results" id="songResults">
                        <!-- Song results will be loaded here -->
                    </div>
                </div>

                <!-- Tags Navigation for Songs by Tags -->
                <div class="tab-content" id="songs-tags-content">
                    <div class="tags-nav" id="tagsNav">
                        <!-- Tags navigation will be generated here -->
                    </div>
                    <div class="tag-results" id="tagResults">
                        <!-- Tag results will be loaded here -->
                    </div>
                </div>
            </section>
        </div>
    </main>



    <!-- Tooltip for first-time users -->
    <div class="tooltip" id="voteTooltip" style="display: none;">
        <div class="tooltip-content">
            Tap icon to vote
            <button class="tooltip-close" id="tooltipClose">Ã—</button>
        </div>
    </div>
    <footer class="footer-nav">
  <button class="footer-btn home-btn playlist-btn" id="playlistBtn" aria-label="Playlist">
    <svg width="32" height="32" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M16.7156 2.28167L9.21564 0.0316707C8.98858 -0.036485 8.74267 0.00671972 8.55245 0.148188C8.36222 0.289657 8.25008 0.512733 8.25001 0.749796V10.8992C6.66714 9.48341 4.30996 9.36695 2.59524 10.6198C0.88053 11.8726 0.275082 14.1537 1.1428 16.092C2.01053 18.0303 4.1152 19.0981 6.19181 18.6536C8.26842 18.2092 9.75165 16.3734 9.75001 14.2498V6.25761L16.2844 8.21792C16.5114 8.28608 16.7574 8.24287 16.9476 8.1014C17.1378 7.95993 17.2499 7.73686 17.25 7.4998V2.9998C17.2499 2.66871 17.0327 2.37686 16.7156 2.28167ZM5.25001 17.2498C3.59316 17.2498 2.25001 15.9067 2.25001 14.2498C2.25001 12.5929 3.59316 11.2498 5.25001 11.2498C6.90687 11.2498 8.25001 12.5929 8.25001 14.2498C8.25001 15.9067 6.90687 17.2498 5.25001 17.2498ZM15.75 6.49198L9.75001 4.69198V1.75761L15.75 3.5623V6.49198Z" fill="#7C7256"/>
    </svg>
    <span>Playlist</span>
  </button>
</footer>
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner" style="display: none;">
        <div class="spinner"></div>
    </div>

    <!-- Error Message -->
    <div class="error-message" id="errorMessage" style="display: none;">
        <div class="error-content">
            <p id="errorText"></p>
            <button class="error-close" id="errorClose">Ã—</button>
        </div>
    </div>

    <!-- <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script> -->

    <script type="module" src="js/fetchCurrentSong.js"></script>
    <script type="module" src="js/detectOverflow.js"></script>
    <script type="module" src="js/fetchTildeSongs.js"></script>
    <script type="module">
  import { fetchPlaylist } from './js/fetchPlaylist.js';

  async function renderPlaylist() {
    const container = document.getElementById('songList');
    if (!container) return;

    container.innerHTML = '';

    const songs = await fetchPlaylist();

    if (songs.length === 0) {
      container.innerHTML = '<p>No songs found in the playlist.</p>';
      return;
    }

    // ===== Now Playing =====
    const nowPlaying = songs[0];
    const nowPlayingSection = document.createElement('section');
    nowPlayingSection.className = 'now-playing';
    nowPlayingSection.id = 'nowPlaying';
    nowPlayingSection.innerHTML = `
      <div class="section-header">
        <h2>Now Playing</h2>
        <button class="refresh-btn" id="refreshBtn">
          <span class="visually-hidden">Refresh</span>
          <svg width="22" height="17" viewBox="0 0 22 17" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
            <path d="M13.2 7.28563H16.3889L16.3878 7.2747C16.2442 6.4983 15.9631 5.76086 15.5606 5.1047C14.9617 4.13059 14.1216 3.3672 13.1406 2.90556C12.8084 2.75013 12.4619 2.63113 12.1088 2.55219C11.3763 2.38825 10.6215 2.38825 9.889 2.55219C8.83633 2.79031 7.87039 3.36508 7.1115 4.20489L5.5539 2.49026C6.25591 1.71509 7.08647 1.09627 8.0003 0.667564C8.46635 0.44975 8.95091 0.283781 9.4468 0.17212C10.47 -0.0573735 11.5245 -0.0573735 12.5477 0.17212C13.044 0.284244 13.5289 0.450617 13.9953 0.668778C15.3697 1.31249 16.5463 2.38108 17.3833 3.74587C17.9466 4.66615 18.3406 5.69971 18.5427 6.78775C18.5735 6.95169 18.59 7.11926 18.612 7.28563H22L17.6 12.1429L13.2 7.28563ZM8.8 9.71427H5.6111L5.6122 9.72399C5.89961 11.2805 6.73066 12.6494 7.9255 13.5345C8.5197 13.9792 9.18779 14.2895 9.8912 14.4477C10.6233 14.6116 11.3778 14.6116 12.1099 14.4477C12.8132 14.2891 13.4812 13.9788 14.0756 13.5345C14.3675 13.3166 14.6401 13.0685 14.8896 12.7938L16.445 14.5109C15.7426 15.2858 14.9117 15.9042 13.9975 16.3323C13.5311 16.5509 13.0438 16.7173 12.551 16.8278C11.5282 17.0574 10.474 17.0574 9.4512 16.8278C7.4794 16.376 5.74499 15.093 4.6167 13.2516C4.05393 12.332 3.66037 11.2993 3.4584 10.2121C3.4287 10.0482 3.4111 9.88063 3.3891 9.71427H0L4.4 4.85698L8.8 9.71427Z" fill="#AC9D78"/>
          </svg>
        </button>
      </div>
      <div class="current-song" id="currentSong">
        <img id="now-playing-image" src="${nowPlaying.image || 'assets/default-artwork.svg'}" alt="Current song artwork" />
        <div class="song-details">
          <div class="now-playing-title-wrapper" id="scrollingText">
            <h3 id="now-playing-title">${nowPlaying.title}</h3>
          </div>
          <p id="now-playing-artist">${nowPlaying.artist}</p>
          <p id="now-playing-user"></p>
          <p id="now-playing-shout-out"></p>
        </div>
        <div class="vote-box-filled">
          <p id="now-playing-votes">0</p>
        </div>
      </div>
    `;
    container.appendChild(nowPlayingSection);

    // ===== Up Next First Song =====
    const upNext = document.createElement('section');
    upNext.className = 'up-next';
    upNext.id = 'upNext';
    upNext.innerHTML = `
      <h2>Up Next</h2>
      <div class="song-list" id="songList">
        <div class="white-outline-box" id="upNextFirstSong">
          <div class="song-row">
            <img src="${songs[1]?.image || 'assets/default-artwork.svg'}" alt="Artwork" class="song-artwork" />
            <div class="song-info">
              <span class="song-title">${songs[1]?.title}</span><br>
              <span class="song-artist">${songs[1]?.artist}</span>
            </div>
            <button class="vote-box">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <rect x="11" y="4" width="2" height="16" rx="1" fill="#AC9D78"/>
                <rect x="4" y="11" width="16" height="2" rx="1" fill="#AC9D78"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    `;
    container.appendChild(upNext);

    // ===== Remaining Songs =====
    const stack = document.createElement('div');
    stack.className = 'white-outline-stack';
    stack.id = 'upNextOtherSongs';

    for (let i = 2; i < songs.length; i++) {
      const song = songs[i];
      const row = document.createElement('div');
      row.className = 'song-row';
      row.innerHTML = `
        <img src="${song.image || 'assets/default-artwork.svg'}" alt="Artwork" class="song-artwork" />
        <div class="song-info">
          <span class="song-title">${song.title}</span><br>
          <span class="song-artist">${song.artist}</span>
        </div>
        <button class="vote-box">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <rect x="11" y="4" width="2" height="16" rx="1" fill="#AC9D78"/>
            <rect x="4" y="11" width="16" height="2" rx="1" fill="#AC9D78"/>
          </svg>
        </button>
      `;
      stack.appendChild(row);
    }

    const upNextList = upNext.querySelector('.song-list');
    upNextList.appendChild(stack);
  }

  document.addEventListener('DOMContentLoaded', renderPlaylist);
</script>



</body>
</html>
